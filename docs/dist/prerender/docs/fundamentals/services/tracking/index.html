<!DOCTYPE html>
<html lang="en" data-reactroot=""><head><link rel="stylesheet" href="/dist/server.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css"/><link rel="stylesheet" href="/dist/client.css"/><link rel="icon" type="image/png" href="/assets/img/favicon-32x32.png"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="description" content="Sitecore JavaScript Services Documentation"/><title data-react-helmet="true">JSS View Engine/SSR | Sitecore JSS Documentation</title></head><body><div id="app"><section class="ant-layout" id="app-wrap"><header class="ant-layout-header"><div class="ant-row ant-row-start" style="padding:30px"><a style="flex:300px" href="/"><img src="/assets/img/sitecore-logo.svg" height="53px" alt="Sitecore JSS" class="logo"/></a><ul flex="auto" style="border-bottom:none" class="ant-menu ant-menu-light ant-menu-root ant-menu-horizontal" role="menu"><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem"><a class="nav-link" href="/features">Features</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item ant-menu-item-only-child ant-menu-item-selected" role="menuitem"><a class="nav-link" href="/docs">Documentation</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem"><a class="nav-link" href="/guides">Guides</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem"><a class="nav-link" target="_blank" rel="noopener noreferrer" href="https://www.sitecore.com/getting-started/developer-trial">Trial</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem"><a class="nav-link" href="/community">Community</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item get-started-button ant-menu-item-only-child" role="menuitem"><a class="btn btn-secondary btn-sm float-left text-white" href="/docs/getting-started/quick-start">Get Started</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="visibility:hidden;position:absolute" role="menuitem"><div class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li></ul></div></header><div class="main-wrapper"><section class="ant-layout border-bottom"><section class="jumbo-container jumbo-container-short bg-light"><div class="default"><div class="circleContainer"><div class="circleContainer-outer-top"><div class="circleContainer-inner"><div class="circleContainer-inner-primary"><div class="circ circ_right circle-fg-right-lg bg-success" id="defaultimage"><img src="/assets/img/transparent-1x1.png"/></div></div><div class="circleContainer-inner-secondary"><div class="circ circ_right circle-fg-right-lg-sub bg-primary"></div></div></div></div><div class="circleContainer-outer-bottom"><div class="circleContainer-inner"><div class="circleContainer-inner-primary"><div class="circle circle-fg-left-md bg-success"></div></div></div></div></div><div class="shapes-wrapper"><div class="outer-shape container"><div class="inner-shape row"><div class="content-wrapper col-12 col-md-9 min-height"><div class="content-wrapper-inner"><h1 class="title mb-3">Documentation</h1><p class="copy mb-0 p-0">Read and search through all the Sitecore JSS documentation</p></div></div></div></div></div></div></section></section><div class="ant-row ant-row-space-between" style="margin-left:-20px;margin-right:-20px;flex-wrap:nowrap;margin:30px"><div style="padding-left:20px;padding-right:20px;flex:0 0 300px" class="ant-col"><aside><div class="side-nav"><form class="bd-search d-flex align-items-center"><input type="search" class="form-control" id="search-input" placeholder="Search..." aria-label="Search for..." autoComplete="off"/><button class="btn btn-link bd-search-docs-toggle d-md-none p-0 ml-3" type="button" data-toggle="collapse" data-target="#bd-docs-nav" aria-controls="bd-docs-nav" aria-expanded="false" aria-label="Toggle docs navigation"></button></form><ul class="ant-menu ant-menu-light ant-menu-root ant-menu-inline" role="menu"><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" role="button" aria-expanded="true" aria-owns="getting-started$Menu" aria-haspopup="true" title="Getting Started">Getting Started<i class="ant-menu-submenu-arrow"></i></div><ul id="getting-started$Menu" class="ant-menu ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item ant-menu-item-only-child" role="menuitem" style="padding-left:48px"><a href="/docs/getting-started/quick-start">1. Quick Start</a></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem" style="padding-left:48px"><a href="/docs/getting-started/first-component">2. Your First Component</a></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem" style="padding-left:48px"><a href="/docs/getting-started/jss-server-install">3. JSS Server Setup</a></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem" style="padding-left:48px"><a href="/docs/getting-started/app-deployment">4. App Deployment</a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-selected" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true" title="Fundamentals">Fundamentals<i class="ant-menu-submenu-arrow"></i></div><div></div></li><li class="ant-menu-submenu ant-menu-submenu-inline" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true" title="Client Frameworks">Client Frameworks<i class="ant-menu-submenu-arrow"></i></div><div></div></li><li class="ant-menu-submenu ant-menu-submenu-inline" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true" title="Techniques">Techniques<i class="ant-menu-submenu-arrow"></i></div><div></div></li></ul><div class="navbar-nav bd-navbar-nav flex-column"><a class="nav-link" href="/release-notes">Release Notes</a><a class="nav-link" href="/help">Help</a></div></div></aside></div><div style="padding-left:20px;padding-right:20px;flex:auto" class="ant-col"><main><div class="article markdown-section" match="[object Object]" location="[object Object]" history="[object Object]"><h1 id="jss-tracking">JSS Tracking</h1>
<p>JSS ships with an analytics tracking API that allows pushing Sitecore analytics events to the xDB based on client-side behaviour in JSS apps.</p>
<p>Before using JSS tracking <a href="https://doc.sitecore.net/developers/xp/index.html">familiarize yourself with the Sitecore XP features</a>.</p>
<p>The JSS tracker supports tracking Events, Goals, Outcomes, Campaigns, and Page/Route Views by default. It is designed to be extensible for advanced tracking needs.</p>
<h2 id="setup">Setup</h2>
<p>The JSS tracker comes installed but <strong>disabled by default</strong> when the <a href="/docs/getting-started/jss-server-install">JSS server components</a> are installed. To enable the JSS tracker, patch the <code>Sitecore.JSS.TrackerServiceEnabled</code> setting to true in a configuration patch file such as:</p>
<pre><code class="xml language-xml">&lt;configuration&gt;
  &lt;sitecore&gt;
    &lt;settings&gt;
      &lt;setting name="Sitecore.JSS.TrackerServiceEnabled" value="true" /&gt;
    &lt;/settings&gt;
  &lt;/sitecore&gt;
&lt;/configuration&gt;
</code></pre>
<p>The JSS tracker utilizes <a href="https://doc.sitecore.net/sitecore_experience_platform/developing/developing_with_sitecore/sitecoreservicesclient/api_keys_for_the_odata_item_service">SSC API keys</a> just like other JSS services. The API keys are used to enable CORS support for the tracker. It is good practice to use one API key for each JSS app, and it can be shared for all JSS services the app uses.</p>
<p>For testing purposes, you may wish to <a href="https://doc.sitecore.net/developers/xp/xconnect/xconnect-search-indexer/enable-anonymous-contact-indexing.html">enable indexing of anonymous contacts</a> to more easily see the results of your testing. By default Sitecore does not index anonymous contact data, which means non-identified users will not have their data in the Experience Profile. JSS Tracker does not support identifying contacts out of the box (but it can be <a href="https://doc.sitecore.com/developers/93/sitecore-experience-platform/en/identifying-contacts.html">extended to do so</a>). Indexing anonymous contacts is not generally advisable in production.</p>
<h2 id="usage">Usage</h2>
<p>The JSS tracker's client-side implementation is the <code>@sitecore-jss/sitecore-jss-tracking</code> npm package. This package is a lightweight wrapper around the tracking service that provides a simple promise-based API and TypeScript typings support to make it easy to use.</p>
<p>Here's a basic example of using the tracking API:</p>
<pre><code class="js language-js">import { trackingApi } from '@sitecore-jss/sitecore-jss-tracking';

const trackingApiOptions = {
  host: config.sitecoreApiHost,
  querystringParams: {
    sc_apikey: config.sitecoreApiKey,
  },
};

trackingApi
  // note the events are an array - batching is supported
  .trackEvent([{ eventId: 'Download' }], trackingApiOptions)
  .then(() =&gt; console.log('Page event pushed'))
  .catch((error) =&gt; console.error(error));
</code></pre>
<p>The tracking API ships with TypeScript typings, so with TS-aware editors like VS Code annotated code completion is available.</p>
<blockquote>
  <p>Note: the tracking API will automatically disable itself during server-side rendering to avoid double-counting when rehydrated on the client-side.</p>
</blockquote>
<h3 id="tracking-page-views">Tracking Page Views</h3>
<p>The tracking API supports tracking arbitrary page view events. This can be useful for things like tracking route changes that do not involve a Layout Service request (cached, custom routes, etc). When tracking page views, it's important to know:</p>
<ul>
<li>Requests to <a href="/docs/fundamentals/services/layout-service">Layout Service</a> will track a page view by default. This can be disabled by adding <code>tracking=false</code> to the Layout Service request query string (configurable via the <code>dataApi</code> object in JSS apps). Disabling LS tracking may make sense if all page tracking is to be handled using the tracking API.</li>
<li>Page view events require a Sitecore Item ID to track against, even though the URL tracked is arbitrary. If tracking non-item-based routes, you may need to create surrogate items to track against.</li>
</ul>
<pre><code class="js language-js">trackingApi
  .trackEvent(
    [{ pageId: '{110D559F-DEA5-42EA-9C1C-8A5DF7E70EF9}', url: '/' }],
    trackingApiOptions
  )
</code></pre>
<h3 id="testingviewing-captured-data">Testing/Viewing Captured Data</h3>
<p>To see the data pushed by your tracking code, the easiest way is to use the <a href="https://doc.sitecore.net/sitecore_experience_platform/digital_marketing/experience_profile/experience_profile">xProfile</a>. Sitecore does not store or index the tracked data into xProfile until after the user session ends; thus it is essential to end your session to see the test data. The styleguide tracking example includes an example button that invokes the JSS tracker session abandon method that will cause an instant data flush. This can also be manually invoked on your Sitecore instance by visiting <code>/sitecore/api/jss/track/flush</code>.</p>
<p>Because tracking data is submitted directly to a Sitecore service, you cannot use the JSS tracking API in <a href="/docs/fundamentals/application-modes">disconnected mode</a>. There are also limitations when in Connected Mode due to cookie data; see below.</p>
<blockquote>
  <p>Not seeing any data in xProfile after ending your session? There are several possible causes:</p>
  <ul>
  <li>Ensure you have an XP-enabled Sitecore license (XM cannot use tracking)</li>
  <li>Your analytics ID has been flagged as robot traffic and dropped. Check the value of the <code>SC_ANALYTICS_GLOBAL_COOKIE</code> cookie; if it ends with <code>|False</code>, your analytics ID is flagged as a robot. A common cause of this is using <a href="/docs/fundamentals/application-modes">connected mode</a> with the tracker; unless a pre-existing analytics cookie is in your browser for the layout service host from <em>integrated mode</em>, the robot detection process will not operate in connected mode and you will be flagged a robot. Visit the app in integrated mode, clear your analytics cookie, refresh, and move your mouse to be redetected as a human visitor.</li>
  <li>Your analytics ID is not <a href="https://doc.sitecore.net/developers/xp/tracking-and-session/tracker/tracking-contacts/identification/index.html">identified</a>, and <a href="https://doc.sitecore.net/developers/xp/xconnect/xconnect-search-indexer/enable-anonymous-contact-indexing.html">indexing anonymous contacts</a> is disabled, which will prevent your un-identified data from showing up in xProfile.</li>
  </ul>
</blockquote>
<h2 id="extension">Extension</h2>
<p>The JSS tracker is a tracking data conduit, and can be extended or modified as needed. The <code>trackEvent</code> pipeline, defined in <code>App_Config\Sitecore\JavaScriptServices\Sitecore.JavaScriptServices.Tracker.config</code>, is responsible for handling incoming tracking requests.</p>
<p>New or replaced pipeline processors can be <a href="https://doc.sitecore.net/sitecore_experience_platform/developing/developing_with_sitecore/customizing_server_configuration/use_a_patch_file_to_customize_the_sitecore_configuration">patched</a> into the config. Processors should derive from <code>Sitecore.JavaScriptServices.Tracker.Pipelines.TrackEvent&lt;T&gt;</code>, where <code>T</code> is a C# type to deserialize the incoming JSON to. The pipeline processor's <code>TrackEvent</code> method should:</p>
<ul>
<li>Return if the incoming request was not something it can handle (i.e. continue pipeline)</li>
<li>Call <code>args.HasBeenTracked()</code> and abort the pipeline if it can handle the incoming request</li>
<li>Call <code>args.ReportError()</code> and return if it <em>can</em> handle the request, but encountered an error doing so</li>
</ul>
</div><hr/><div>Found a problem? Have something to add? <a href="https://github.com/Sitecore/jss/edit/dev/docs/data/routes/docs/fundamentals/services/view-engine/en.md">Edit this on GitHub</a></div></main></div></div></div><footer class="ant-layout-footer"><div class="ant-row ant-row-center" style="margin-left:-16px;margin-right:-16px"><div style="padding-left:16px;padding-right:16px" class="ant-col ant-col-xs-24 ant-col-md-5"><a class="nav-link text-uppercase small text-white font-weight-bold" href="/features">Features</a><nav class="nav flex-column"><a class="nav-link small text-white" href="/features/why-jss">Why JSS?</a><a class="nav-link small text-white" href="/features/why-sitecore">Why Sitecore?</a></nav></div><div style="padding-left:16px;padding-right:16px" class="ant-col ant-col-xs-24 ant-col-md-5"><a class="nav-link text-uppercase small text-white font-weight-bold" href="/docs">Documentation</a><nav class="nav flex-column"><a class="nav-link small text-white" href="/docs/getting-started/quick-start">Getting Started</a><a class="nav-link small text-white" href="/docs/fundamentals/architecture">Fundamentals</a><a class="nav-link small text-white" href="/docs/client-frameworks/react/react-overview">Client Frameworks</a><a class="nav-link small text-white" href="/docs/techniques/mvc-integration/javascript-rendering">Techniques</a><a class="nav-link small text-white" href="/release-notes">Release Notes</a><a class="nav-link small text-white" href="/help">FAQs</a></nav></div><div style="padding-left:16px;padding-right:16px" class="ant-col ant-col-xs-24 ant-col-md-5"><a href="https://www.sitecore.com/getting-started/developer-trial" target="_blank" rel="noopener noreferrer" class="nav-link text-uppercase small text-white font-weight-bold">Start Trial</a></div><div style="padding-left:16px;padding-right:16px" class="ant-col ant-col-xs-24 ant-col-md-5"><a class="nav-link text-uppercase small text-white font-weight-bold" href="/community">Community</a><nav class="nav flex-column"><a href="#" class="nav-link small text-white">Sitecore Community</a><a href="slack://channel?team=T09SHRBNU&amp;id=C7JT0NRQW" class="nav-link small text-white"><svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" focusable="false"><title>Slack</title><path fill="currentColor" d="M210.787 234.832l68.31-22.883 22.1 65.977-68.309 22.882z"></path><path d="M490.54 185.6C437.7 9.59 361.6-31.34 185.6 21.46S-31.3 150.4 21.46 326.4 150.4 543.3 326.4 490.54 543.34 361.6 490.54 185.6zM401.7 299.8l-33.15 11.05 11.46 34.38c4.5 13.92-2.87 29.06-16.78 33.56-2.87.82-6.14 1.64-9 1.23a27.32 27.32 0 0 1-24.56-18l-11.46-34.38-68.36 22.92 11.46 34.38c4.5 13.92-2.87 29.06-16.78 33.56-2.87.82-6.14 1.64-9 1.23a27.32 27.32 0 0 1-24.56-18l-11.46-34.43-33.15 11.05c-2.87.82-6.14 1.64-9 1.23a27.32 27.32 0 0 1-24.56-18c-4.5-13.92 2.87-29.06 16.78-33.56l33.12-11.03-22.1-65.9-33.15 11.05c-2.87.82-6.14 1.64-9 1.23a27.32 27.32 0 0 1-24.56-18c-4.48-13.93 2.89-29.07 16.81-33.58l33.15-11.05-11.46-34.38c-4.5-13.92 2.87-29.06 16.78-33.56s29.06 2.87 33.56 16.78l11.46 34.38 68.36-22.92-11.46-34.38c-4.5-13.92 2.87-29.06 16.78-33.56s29.06 2.87 33.56 16.78l11.47 34.42 33.15-11.05c13.92-4.5 29.06 2.87 33.56 16.78s-2.87 29.06-16.78 33.56L329.7 194.6l22.1 65.9 33.15-11.05c13.92-4.5 29.06 2.87 33.56 16.78s-2.88 29.07-16.81 33.57z" fill="currentColor"></path></svg>JSS Slack</a><a href="https://sitecore.stackexchange.com/tags/jss" class="nav-link small text-white"><svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 120 120"><title>Sitecore StackExchange</title><path fill="currentColor" d="M22.4 57.5h74.8v15.4H22.4z"></path><path fill="currentColor" d="M22.4 37.6h74.8V53H22.4z"></path><path fill="currentColor" d="M85.5 17H34.4c-6.6 0-12 5.5-12 12.3v4h74.8v-4C97.2 22.5 92 17 85.5 17z"></path><path fill="currentColor" d="M22.4 77.3v4c0 6.8 5.4 12.3 12 12.3h32v16.3l15.8-16.3h3.5c6.6 0 12-5.5 12-12.3v-4H22.4z"></path></svg>Stack Exchange</a><a href="https://github.com/sitecore/jss" class="nav-link small text-white"><svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 499.36" focusable="false"><title>GitHub</title><path d="M256 0C114.64 0 0 114.61 0 256c0 113.09 73.34 209 175.08 242.9 12.8 2.35 17.47-5.56 17.47-12.34 0-6.08-.22-22.18-.35-43.54-71.2 15.49-86.2-34.34-86.2-34.34-11.64-29.57-28.42-37.45-28.42-37.45-23.27-15.84 1.73-15.55 1.73-15.55 25.69 1.81 39.21 26.38 39.21 26.38 22.84 39.12 59.92 27.82 74.5 21.27 2.33-16.54 8.94-27.82 16.25-34.22-56.84-6.43-116.6-28.43-116.6-126.49 0-27.95 10-50.8 26.35-68.69-2.63-6.48-11.42-32.5 2.51-67.75 0 0 21.49-6.88 70.4 26.24a242.65 242.65 0 0 1 128.18 0c48.87-33.13 70.33-26.24 70.33-26.24 14 35.25 5.18 61.27 2.55 67.75 16.41 17.9 26.31 40.75 26.31 68.69 0 98.35-59.85 120-116.88 126.32 9.19 7.9 17.38 23.53 17.38 47.41 0 34.22-.31 61.83-.31 70.23 0 6.85 4.61 14.81 17.6 12.31C438.72 464.97 512 369.08 512 256.02 512 114.62 397.37 0 256 0z" fill="currentColor" fill-rule="evenodd"></path></svg>Github</a></nav></div></div><div class="ant-row ant-row-center" style="margin:30px"><div class="ant-col footer-copyright small">© Copyright <!-- -->2020<!-- -->, Sitecore. All Rights Reserved.</div><div class="ant-col footer-copyright small"><a href="https://www.sitecore.com/trust" class="pl-2 pr-2" target="_blank" rel="noopener noreferrer">Legal</a><a href="https://www.sitecore.com/trust/privacy-policy" class="pl-2" target="_blank" rel="noopener noreferrer">Privacy</a></div></div></footer></section></div><script>window.__data={"sitecore":{"context":{"pageEditing":false,"site":{"name":"JssDisconnectedLayoutService"},"pageState":"normal","language":"en"},"route":{"databaseName":"available-in-connected-mode","deviceId":"available-in-connected-mode","itemId":"available-in-connected-mode","itemLanguage":"en","itemVersion":1,"layoutId":"available-in-connected-mode","templateId":"available-in-connected-mode","templateName":"Docs Route","name":"tracking","fields":{"title":{"value":"JSS Tracking"},"editLink":{"value":{"text":"Edit this on GitHub","href":"https://github.com/Sitecore/jss/edit/dev/docs/data/routes/docs/fundamentals/services/tracking/en.md"}}},"placeholders":{"jssdocs-header":[{"uid":"{5D7369A6-8767-5D61-A65C-D6641071D790}","componentName":"Row","dataSource":"available-in-connected-mode","params":{"justify":"start","padding":"30px"},"fields":{},"placeholders":{"jssdocs-row":[{"uid":"{938E0C52-D86C-5C49-8332-69DBB9AD749A}","componentName":"Logo","dataSource":"available-in-connected-mode","params":{"flex":"300px"},"fields":{}},{"uid":"{30172E53-4575-5AA3-A76F-2922BB91C982}","componentName":"MainNav","dataSource":"available-in-connected-mode","params":{"flex":"auto"},"fields":{"selectedMenuItem":{"value":"docs"}}}]}}],"jssdocs-main":[{"uid":"{E5BCEFE8-E635-58D3-AD06-3AE0D31B1BF6}","componentName":"ArticleContainer","dataSource":"available-in-connected-mode","params":{},"fields":{},"placeholders":{"jssdocs-jumbo":[{"uid":"{CB5DA140-8CE9-5011-9139-33C7EF3BF997}","componentName":"FeatureJumboShort","dataSource":"available-in-connected-mode","params":{},"fields":{"image":{"value":{"src":"/assets/img/transparent-1x1.png"}},"imageclass":{"value":"defaultimage"},"csscolorclass":{"value":"default"},"title":{"value":"Documentation"},"text":{"value":"Read and search through all the Sitecore JSS documentation"}}}],"jssdocs-aside":[{"uid":"{77216ABB-8267-5ED5-A6AB-9020650F378A}","componentName":"SideNav","dataSource":"available-in-connected-mode","params":{},"fields":{"navType":{"value":"docs"},"useSearch":{"value":"true"}}}],"jssdocs-content":[{"uid":"{BA51E40A-37F3-5EBA-8BC1-6FE8E4EADD14}","componentName":"Article","dataSource":"available-in-connected-mode","params":{},"fields":{"text":{"value":"<h1 id=\"jss-tracking\">JSS Tracking</h1>\n<p>JSS ships with an analytics tracking API that allows pushing Sitecore analytics events to the xDB based on client-side behaviour in JSS apps.</p>\n<p>Before using JSS tracking <a href=\"https://doc.sitecore.net/developers/xp/index.html\">familiarize yourself with the Sitecore XP features</a>.</p>\n<p>The JSS tracker supports tracking Events, Goals, Outcomes, Campaigns, and Page/Route Views by default. It is designed to be extensible for advanced tracking needs.</p>\n<h2 id=\"setup\">Setup</h2>\n<p>The JSS tracker comes installed but <strong>disabled by default</strong> when the <a href=\"/docs/getting-started/jss-server-install\">JSS server components</a> are installed. To enable the JSS tracker, patch the <code>Sitecore.JSS.TrackerServiceEnabled</code> setting to true in a configuration patch file such as:</p>\n<pre><code class=\"xml language-xml\">&lt;configuration&gt;\n  &lt;sitecore&gt;\n    &lt;settings&gt;\n      &lt;setting name=\"Sitecore.JSS.TrackerServiceEnabled\" value=\"true\" /&gt;\n    &lt;/settings&gt;\n  &lt;/sitecore&gt;\n&lt;/configuration&gt;\n</code></pre>\n<p>The JSS tracker utilizes <a href=\"https://doc.sitecore.net/sitecore_experience_platform/developing/developing_with_sitecore/sitecoreservicesclient/api_keys_for_the_odata_item_service\">SSC API keys</a> just like other JSS services. The API keys are used to enable CORS support for the tracker. It is good practice to use one API key for each JSS app, and it can be shared for all JSS services the app uses.</p>\n<p>For testing purposes, you may wish to <a href=\"https://doc.sitecore.net/developers/xp/xconnect/xconnect-search-indexer/enable-anonymous-contact-indexing.html\">enable indexing of anonymous contacts</a> to more easily see the results of your testing. By default Sitecore does not index anonymous contact data, which means non-identified users will not have their data in the Experience Profile. JSS Tracker does not support identifying contacts out of the box (but it can be <a href=\"https://doc.sitecore.com/developers/93/sitecore-experience-platform/en/identifying-contacts.html\">extended to do so</a>). Indexing anonymous contacts is not generally advisable in production.</p>\n<h2 id=\"usage\">Usage</h2>\n<p>The JSS tracker's client-side implementation is the <code>@sitecore-jss/sitecore-jss-tracking</code> npm package. This package is a lightweight wrapper around the tracking service that provides a simple promise-based API and TypeScript typings support to make it easy to use.</p>\n<p>Here's a basic example of using the tracking API:</p>\n<pre><code class=\"js language-js\">import { trackingApi } from '@sitecore-jss/sitecore-jss-tracking';\n\nconst trackingApiOptions = {\n  host: config.sitecoreApiHost,\n  querystringParams: {\n    sc_apikey: config.sitecoreApiKey,\n  },\n};\n\ntrackingApi\n  // note the events are an array - batching is supported\n  .trackEvent([{ eventId: 'Download' }], trackingApiOptions)\n  .then(() =&gt; console.log('Page event pushed'))\n  .catch((error) =&gt; console.error(error));\n</code></pre>\n<p>The tracking API ships with TypeScript typings, so with TS-aware editors like VS Code annotated code completion is available.</p>\n<blockquote>\n  <p>Note: the tracking API will automatically disable itself during server-side rendering to avoid double-counting when rehydrated on the client-side.</p>\n</blockquote>\n<h3 id=\"tracking-page-views\">Tracking Page Views</h3>\n<p>The tracking API supports tracking arbitrary page view events. This can be useful for things like tracking route changes that do not involve a Layout Service request (cached, custom routes, etc). When tracking page views, it's important to know:</p>\n<ul>\n<li>Requests to <a href=\"/docs/fundamentals/services/layout-service\">Layout Service</a> will track a page view by default. This can be disabled by adding <code>tracking=false</code> to the Layout Service request query string (configurable via the <code>dataApi</code> object in JSS apps). Disabling LS tracking may make sense if all page tracking is to be handled using the tracking API.</li>\n<li>Page view events require a Sitecore Item ID to track against, even though the URL tracked is arbitrary. If tracking non-item-based routes, you may need to create surrogate items to track against.</li>\n</ul>\n<pre><code class=\"js language-js\">trackingApi\n  .trackEvent(\n    [{ pageId: '{110D559F-DEA5-42EA-9C1C-8A5DF7E70EF9}', url: '/' }],\n    trackingApiOptions\n  )\n</code></pre>\n<h3 id=\"testingviewing-captured-data\">Testing/Viewing Captured Data</h3>\n<p>To see the data pushed by your tracking code, the easiest way is to use the <a href=\"https://doc.sitecore.net/sitecore_experience_platform/digital_marketing/experience_profile/experience_profile\">xProfile</a>. Sitecore does not store or index the tracked data into xProfile until after the user session ends; thus it is essential to end your session to see the test data. The styleguide tracking example includes an example button that invokes the JSS tracker session abandon method that will cause an instant data flush. This can also be manually invoked on your Sitecore instance by visiting <code>/sitecore/api/jss/track/flush</code>.</p>\n<p>Because tracking data is submitted directly to a Sitecore service, you cannot use the JSS tracking API in <a href=\"/docs/fundamentals/application-modes\">disconnected mode</a>. There are also limitations when in Connected Mode due to cookie data; see below.</p>\n<blockquote>\n  <p>Not seeing any data in xProfile after ending your session? There are several possible causes:</p>\n  <ul>\n  <li>Ensure you have an XP-enabled Sitecore license (XM cannot use tracking)</li>\n  <li>Your analytics ID has been flagged as robot traffic and dropped. Check the value of the <code>SC_ANALYTICS_GLOBAL_COOKIE</code> cookie; if it ends with <code>|False</code>, your analytics ID is flagged as a robot. A common cause of this is using <a href=\"/docs/fundamentals/application-modes\">connected mode</a> with the tracker; unless a pre-existing analytics cookie is in your browser for the layout service host from <em>integrated mode</em>, the robot detection process will not operate in connected mode and you will be flagged a robot. Visit the app in integrated mode, clear your analytics cookie, refresh, and move your mouse to be redetected as a human visitor.</li>\n  <li>Your analytics ID is not <a href=\"https://doc.sitecore.net/developers/xp/tracking-and-session/tracker/tracking-contacts/identification/index.html\">identified</a>, and <a href=\"https://doc.sitecore.net/developers/xp/xconnect/xconnect-search-indexer/enable-anonymous-contact-indexing.html\">indexing anonymous contacts</a> is disabled, which will prevent your un-identified data from showing up in xProfile.</li>\n  </ul>\n</blockquote>\n<h2 id=\"extension\">Extension</h2>\n<p>The JSS tracker is a tracking data conduit, and can be extended or modified as needed. The <code>trackEvent</code> pipeline, defined in <code>App_Config\\Sitecore\\JavaScriptServices\\Sitecore.JavaScriptServices.Tracker.config</code>, is responsible for handling incoming tracking requests.</p>\n<p>New or replaced pipeline processors can be <a href=\"https://doc.sitecore.net/sitecore_experience_platform/developing/developing_with_sitecore/customizing_server_configuration/use_a_patch_file_to_customize_the_sitecore_configuration\">patched</a> into the config. Processors should derive from <code>Sitecore.JavaScriptServices.Tracker.Pipelines.TrackEvent&lt;T&gt;</code>, where <code>T</code> is a C# type to deserialize the incoming JSON to. The pipeline processor's <code>TrackEvent</code> method should:</p>\n<ul>\n<li>Return if the incoming request was not something it can handle (i.e. continue pipeline)</li>\n<li>Call <code>args.HasBeenTracked()</code> and abort the pipeline if it can handle the incoming request</li>\n<li>Call <code>args.ReportError()</code> and return if it <em>can</em> handle the request, but encountered an error doing so</li>\n</ul>\n"}}}]}}],"jssdocs-footer":[{"uid":"{E194B4B2-B77B-5F62-A264-4A267EC17D99}","componentName":"Row","dataSource":"available-in-connected-mode","params":{"justify":"center","compactGutter":"24","fullSizeGutter":"32"},"fields":{},"placeholders":{"jssdocs-row":[{"uid":"{2288CC6D-BC33-5027-9A2F-4E7B141612CB}","componentName":"FooterNav","dataSource":"available-in-connected-mode","params":{},"fields":{}}]}},{"uid":"{3EE7D114-AC97-5B7A-962E-DE746315FA95}","componentName":"Row","dataSource":"available-in-connected-mode","params":{"justify":"center","margin":"30px"},"fields":{},"placeholders":{"jssdocs-row":[{"uid":"{DDE454EA-390C-5F26-ACFC-3949401679BF}","componentName":"Disclaimers","dataSource":"available-in-connected-mode","params":{},"fields":{}}]}}]}}},"viewBag":{}};</script><script src="/dist/vendor-client.bundle.js"></script><script src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script><script src="/dist/client.bundle.js"></script></body></html>