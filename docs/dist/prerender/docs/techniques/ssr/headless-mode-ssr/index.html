<!DOCTYPE html>
<html lang="en" data-reactroot=""><head><link rel="stylesheet" href="/dist/server.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css"/><link rel="stylesheet" href="/dist/client.css"/><link rel="icon" type="image/png" href="/assets/img/favicon-32x32.png"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="description" content="Sitecore JavaScript Services Documentation"/><title data-react-helmet="true">Server Rendering View Bag | Sitecore JSS Documentation</title></head><body><div id="app"><section class="ant-layout" id="app-wrap"><header class="ant-layout-header"><div class="ant-row ant-row-start" style="padding:30px"><a style="flex:300px" href="/"><img src="/assets/img/sitecore-logo.svg" height="53px" alt="Sitecore JSS" class="logo"/></a><ul flex="auto" style="border-bottom:none" class="ant-menu ant-menu-light ant-menu-root ant-menu-horizontal" role="menu"><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem"><a class="nav-link" href="/features">Features</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item ant-menu-item-only-child ant-menu-item-selected" role="menuitem"><a class="nav-link" href="/docs">Documentation</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem"><a class="nav-link" href="/guides">Guides</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem"><a class="nav-link" target="_blank" rel="noopener noreferrer" href="https://www.sitecore.com/getting-started/developer-trial">Trial</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem"><a class="nav-link" href="/community">Community</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item get-started-button ant-menu-item-only-child" role="menuitem"><a class="btn btn-secondary btn-sm float-left text-white" href="/docs/getting-started/quick-start">Get Started</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="visibility:hidden;position:absolute" role="menuitem"><div class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li></ul></div></header><div class="main-wrapper"><section class="ant-layout border-bottom"><section class="jumbo-container jumbo-container-short bg-light"><div class="default"><div class="circleContainer"><div class="circleContainer-outer-top"><div class="circleContainer-inner"><div class="circleContainer-inner-primary"><div class="circ circ_right circle-fg-right-lg bg-success" id="defaultimage"><img src="/assets/img/transparent-1x1.png"/></div></div><div class="circleContainer-inner-secondary"><div class="circ circ_right circle-fg-right-lg-sub bg-primary"></div></div></div></div><div class="circleContainer-outer-bottom"><div class="circleContainer-inner"><div class="circleContainer-inner-primary"><div class="circle circle-fg-left-md bg-success"></div></div></div></div></div><div class="shapes-wrapper"><div class="outer-shape container"><div class="inner-shape row"><div class="content-wrapper col-12 col-md-9 min-height"><div class="content-wrapper-inner"><h1 class="title mb-3">Documentation</h1><p class="copy mb-0 p-0">Read and search through all the Sitecore JSS documentation</p></div></div></div></div></div></div></section></section><div class="ant-row ant-row-space-between" style="margin-left:-20px;margin-right:-20px;flex-wrap:nowrap;margin:30px"><div style="padding-left:20px;padding-right:20px;flex:0 0 300px" class="ant-col"><aside><div class="side-nav"><form class="bd-search d-flex align-items-center"><input type="search" class="form-control" id="search-input" placeholder="Search..." aria-label="Search for..." autoComplete="off"/><button class="btn btn-link bd-search-docs-toggle d-md-none p-0 ml-3" type="button" data-toggle="collapse" data-target="#bd-docs-nav" aria-controls="bd-docs-nav" aria-expanded="false" aria-label="Toggle docs navigation"></button></form><ul class="ant-menu ant-menu-light ant-menu-root ant-menu-inline" role="menu"><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" role="button" aria-expanded="true" aria-owns="getting-started$Menu" aria-haspopup="true" title="Getting Started">Getting Started<i class="ant-menu-submenu-arrow"></i></div><ul id="getting-started$Menu" class="ant-menu ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item ant-menu-item-only-child" role="menuitem" style="padding-left:48px"><a href="/docs/getting-started/quick-start">1. Quick Start</a></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem" style="padding-left:48px"><a href="/docs/getting-started/first-component">2. Your First Component</a></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem" style="padding-left:48px"><a href="/docs/getting-started/jss-server-install">3. JSS Server Setup</a></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem" style="padding-left:48px"><a href="/docs/getting-started/app-deployment">4. App Deployment</a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true" title="Fundamentals">Fundamentals<i class="ant-menu-submenu-arrow"></i></div><div></div></li><li class="ant-menu-submenu ant-menu-submenu-inline" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true" title="Client Frameworks">Client Frameworks<i class="ant-menu-submenu-arrow"></i></div><div></div></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-selected" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true" title="Techniques">Techniques<i class="ant-menu-submenu-arrow"></i></div><div></div></li></ul><div class="navbar-nav bd-navbar-nav flex-column"><a class="nav-link" href="/release-notes">Release Notes</a><a class="nav-link" href="/help">Help</a></div></div></aside></div><div style="padding-left:20px;padding-right:20px;flex:auto" class="ant-col"><main><div class="article markdown-section" match="[object Object]" location="[object Object]" history="[object Object]"><h1 id="headless-ssr-via-sitecore-jss-proxy">Headless SSR via <code>sitecore-jss-proxy</code></h1>
<p>JSS supports headless server-side rendering using any service that supports hosting Node.js applications. In this technique the JSS app receives an incoming HTTP request, which is then rewritten and proxied into a Layout Service request to a Sitecore server. The reply from Layout Service is then provided to the app's SSR infrastructure to render to HTML, the same way that Integrated Mode would work within Sitecore, and then finally the resultant HTML is returned to the client.</p>
<p>All Sitecore marketing features are supported by this headless mode, including personalization, tracking, multivariate testing, etc.</p>
<h2 id="how-to-use">How to use</h2>
<ol>
<li><p>Clone <a href="https://github.com/sitecore/jss">the JSS samples repository</a> and copy the <code>samples/node-headless-ssr-proxy</code> folder to your disk, for example: <code>c:\jss-headless</code>.</p>
<p>This sample app acts as a HTTP proxy to the Sitecore server, proxying incoming requests to Layout Service, and then rendering the resultant JSON to HTML before returning it. The app is heavily commented.</p></li>
<li><p>Create a production build of your app with <code>jss build</code>. Ensure that the <code>layoutServiceHost</code> in the app's <code>scjssconfig.json</code> is set to the hostname <em>of the <code>node-headless-ssr-proxy</code> proxy</em> (not directly to Sitecore). For local testing, this would default to <code>http://localhost:3000</code>. In production, it would likely be something like <code>https://www.mysite.com</code>. It is also possible to make requests directly to Sitecore, if you do not wish to run everything through the reverse proxy. Proxying the data APIs has the advantage of allowing Sitecore to live behind a firewall.</p></li>
<li><p>Copy the production build artifacts from your app to the proxy (i.e. <code>/node-headless-ssr-proxy/dist/MyApp</code>). The path copied to should match the relative path that is set in the <code>sitecoreDistPath</code> config in the app's <code>package.json</code> file (<code>/dist/MyApp</code> in the previous example).</p></li>
<li><p>Open <code>/config.js</code> file and,</p>
<ul>
<li>Set <code>bundlePath</code> to the path to your built JSS app's <code>server.bundle.js</code>, i.e. <code>'./dist/myappname/server.bundle'</code></li>
<li>Set <code>apiHost</code> to your Sitecore instance host and the <code>apiKey</code> to your SSC API Key (see <a href="/docs/getting-started/jss-server-install">server setup</a> if you don't have an API key yet)</li>
<li>Set <code>apiKey</code> to your Sitecore SSC API key</li>
<li>Set the dictionary service path in <code>createViewBag()</code> to your app's dictionary service URL. If you are not using dictionaries, you can remove the whole <code>createViewBag()</code> function, which enables dictionary caching.</li></ul>
<blockquote>
  <p>NOTE: It is possible to configure these settings using environment variables as well, if that is preferable. This is great for containers and some PaaS hosts.</p>
</blockquote></li>
<li><p>Open a command line in your <code>node-headless-ssr-proxy</code> folder, and run <code>npm install</code> then <code>npm start</code>.</p>
<p>The console should show <code>server listening on port 3000!</code>.<br />
To test, browse to <code>http://localhost:3000/</code> and you should see the same app rendering now in the headless configuration.</p></li>
</ol>
<h2 id="tips--tricks">Tips &amp; Tricks</h2>
<h3 id="media-urls-in-headless-mode">Media URLs in headless mode</h3>
<p>The <a href="/docs/fundamentals/services/layout-service">Layout Service</a> will return URLs to images with the Sitecore server URL included. For example:</p>
<ul>
<li>The Sitecore server is <code>http://siteco.re</code></li>
<li>An image in a media field, or a rich text field, would be returned something like <code>http://sitecor.re/-/media/jss.jpg</code></li>
<li>In headless mode if the proxy is <code>http://proxy</code>, what we really want is <code>http://proxy/-/media/jss.jpg</code> or even better, <code>/-/media/jss.jpg</code></li>
</ul>
<p>In headless mode it is possible to use the headless proxy without exposing the Sitecore server publicly, which makes media URLs that contain the Sitecore server URL problematic. It is easy enough to tell Sitecore to not include the server as part of media requests, however. Place the following contents in a <em>config patch</em> file under <code>App_Config/Include/ADescriptiveName.config</code>:</p>
<pre><code class="xml language-xml">&lt;configuration xmlns:patch="http://www.sitecore.net/xmlconfig/"&gt;
  &lt;sitecore&gt;
    &lt;layoutService&gt;
      &lt;configurations&gt;
        &lt;config name="jss"&gt;
          &lt;rendering&gt;
            &lt;renderingContentsResolver&gt;
              &lt;IncludeServerUrlInMediaUrls&gt;false&lt;/IncludeServerUrlInMediaUrls&gt;
            &lt;/renderingContentsResolver&gt;
          &lt;/rendering&gt;
        &lt;/config&gt;
      &lt;/configurations&gt;
    &lt;/layoutService&gt;
  &lt;/sitecore&gt;
&lt;/configuration&gt;
</code></pre>
<blockquote>
  <p>NOTE: this configuration is appropriate for servers that run <em>headless mode</em> or <em>integrated mode</em> JSS sites - generally Content Delivery servers. Enabling this configuration will cause images to break when JSS sites are run in <em>connected mode</em>, as the images will be served as if local - so do not enable this for servers where development is occurring.</p>
</blockquote>
</div><hr/><div>Found a problem? Have something to add? <a href="https://github.com/Sitecore/jss/edit/dev/docs/data/routes/docs/techniques/ssr/server-rendering-viewbag/en.md">Edit this on GitHub</a></div></main></div></div></div><footer class="ant-layout-footer"><div class="ant-row ant-row-center" style="margin-left:-16px;margin-right:-16px"><div style="padding-left:16px;padding-right:16px" class="ant-col ant-col-xs-24 ant-col-md-5"><a class="nav-link text-uppercase small text-white font-weight-bold" href="/features">Features</a><nav class="nav flex-column"><a class="nav-link small text-white" href="/features/why-jss">Why JSS?</a><a class="nav-link small text-white" href="/features/why-sitecore">Why Sitecore?</a></nav></div><div style="padding-left:16px;padding-right:16px" class="ant-col ant-col-xs-24 ant-col-md-5"><a class="nav-link text-uppercase small text-white font-weight-bold" href="/docs">Documentation</a><nav class="nav flex-column"><a class="nav-link small text-white" href="/docs/getting-started/quick-start">Getting Started</a><a class="nav-link small text-white" href="/docs/fundamentals/architecture">Fundamentals</a><a class="nav-link small text-white" href="/docs/client-frameworks/react/react-overview">Client Frameworks</a><a class="nav-link small text-white" href="/docs/techniques/mvc-integration/javascript-rendering">Techniques</a><a class="nav-link small text-white" href="/release-notes">Release Notes</a><a class="nav-link small text-white" href="/help">FAQs</a></nav></div><div style="padding-left:16px;padding-right:16px" class="ant-col ant-col-xs-24 ant-col-md-5"><a href="https://www.sitecore.com/getting-started/developer-trial" target="_blank" rel="noopener noreferrer" class="nav-link text-uppercase small text-white font-weight-bold">Start Trial</a></div><div style="padding-left:16px;padding-right:16px" class="ant-col ant-col-xs-24 ant-col-md-5"><a class="nav-link text-uppercase small text-white font-weight-bold" href="/community">Community</a><nav class="nav flex-column"><a href="#" class="nav-link small text-white">Sitecore Community</a><a href="slack://channel?team=T09SHRBNU&amp;id=C7JT0NRQW" class="nav-link small text-white"><svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" focusable="false"><title>Slack</title><path fill="currentColor" d="M210.787 234.832l68.31-22.883 22.1 65.977-68.309 22.882z"></path><path d="M490.54 185.6C437.7 9.59 361.6-31.34 185.6 21.46S-31.3 150.4 21.46 326.4 150.4 543.3 326.4 490.54 543.34 361.6 490.54 185.6zM401.7 299.8l-33.15 11.05 11.46 34.38c4.5 13.92-2.87 29.06-16.78 33.56-2.87.82-6.14 1.64-9 1.23a27.32 27.32 0 0 1-24.56-18l-11.46-34.38-68.36 22.92 11.46 34.38c4.5 13.92-2.87 29.06-16.78 33.56-2.87.82-6.14 1.64-9 1.23a27.32 27.32 0 0 1-24.56-18l-11.46-34.43-33.15 11.05c-2.87.82-6.14 1.64-9 1.23a27.32 27.32 0 0 1-24.56-18c-4.5-13.92 2.87-29.06 16.78-33.56l33.12-11.03-22.1-65.9-33.15 11.05c-2.87.82-6.14 1.64-9 1.23a27.32 27.32 0 0 1-24.56-18c-4.48-13.93 2.89-29.07 16.81-33.58l33.15-11.05-11.46-34.38c-4.5-13.92 2.87-29.06 16.78-33.56s29.06 2.87 33.56 16.78l11.46 34.38 68.36-22.92-11.46-34.38c-4.5-13.92 2.87-29.06 16.78-33.56s29.06 2.87 33.56 16.78l11.47 34.42 33.15-11.05c13.92-4.5 29.06 2.87 33.56 16.78s-2.87 29.06-16.78 33.56L329.7 194.6l22.1 65.9 33.15-11.05c13.92-4.5 29.06 2.87 33.56 16.78s-2.88 29.07-16.81 33.57z" fill="currentColor"></path></svg>JSS Slack</a><a href="https://sitecore.stackexchange.com/tags/jss" class="nav-link small text-white"><svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 120 120"><title>Sitecore StackExchange</title><path fill="currentColor" d="M22.4 57.5h74.8v15.4H22.4z"></path><path fill="currentColor" d="M22.4 37.6h74.8V53H22.4z"></path><path fill="currentColor" d="M85.5 17H34.4c-6.6 0-12 5.5-12 12.3v4h74.8v-4C97.2 22.5 92 17 85.5 17z"></path><path fill="currentColor" d="M22.4 77.3v4c0 6.8 5.4 12.3 12 12.3h32v16.3l15.8-16.3h3.5c6.6 0 12-5.5 12-12.3v-4H22.4z"></path></svg>Stack Exchange</a><a href="https://github.com/sitecore/jss" class="nav-link small text-white"><svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 499.36" focusable="false"><title>GitHub</title><path d="M256 0C114.64 0 0 114.61 0 256c0 113.09 73.34 209 175.08 242.9 12.8 2.35 17.47-5.56 17.47-12.34 0-6.08-.22-22.18-.35-43.54-71.2 15.49-86.2-34.34-86.2-34.34-11.64-29.57-28.42-37.45-28.42-37.45-23.27-15.84 1.73-15.55 1.73-15.55 25.69 1.81 39.21 26.38 39.21 26.38 22.84 39.12 59.92 27.82 74.5 21.27 2.33-16.54 8.94-27.82 16.25-34.22-56.84-6.43-116.6-28.43-116.6-126.49 0-27.95 10-50.8 26.35-68.69-2.63-6.48-11.42-32.5 2.51-67.75 0 0 21.49-6.88 70.4 26.24a242.65 242.65 0 0 1 128.18 0c48.87-33.13 70.33-26.24 70.33-26.24 14 35.25 5.18 61.27 2.55 67.75 16.41 17.9 26.31 40.75 26.31 68.69 0 98.35-59.85 120-116.88 126.32 9.19 7.9 17.38 23.53 17.38 47.41 0 34.22-.31 61.83-.31 70.23 0 6.85 4.61 14.81 17.6 12.31C438.72 464.97 512 369.08 512 256.02 512 114.62 397.37 0 256 0z" fill="currentColor" fill-rule="evenodd"></path></svg>Github</a></nav></div></div><div class="ant-row ant-row-center" style="margin:30px"><div class="ant-col footer-copyright small">© Copyright <!-- -->2020<!-- -->, Sitecore. All Rights Reserved.</div><div class="ant-col footer-copyright small"><a href="https://www.sitecore.com/trust" class="pl-2 pr-2" target="_blank" rel="noopener noreferrer">Legal</a><a href="https://www.sitecore.com/trust/privacy-policy" class="pl-2" target="_blank" rel="noopener noreferrer">Privacy</a></div></div></footer></section></div><script>window.__data={"sitecore":{"context":{"pageEditing":false,"site":{"name":"JssDisconnectedLayoutService"},"pageState":"normal","language":"en"},"route":{"databaseName":"available-in-connected-mode","deviceId":"available-in-connected-mode","itemId":"available-in-connected-mode","itemLanguage":"en","itemVersion":1,"layoutId":"available-in-connected-mode","templateId":"available-in-connected-mode","templateName":"Docs Route","name":"headless-mode-ssr","fields":{"title":{"value":"Headless with sitecore-jss-proxy"},"editLink":{"value":{"text":"Edit this on GitHub","href":"https://github.com/Sitecore/jss/edit/dev/docs/data/routes/docs/techniques/ssr/headless-mode-ssr/en.md"}}},"placeholders":{"jssdocs-header":[{"uid":"{8424CB8A-5DF2-5257-A76F-322F20672A85}","componentName":"Row","dataSource":"available-in-connected-mode","params":{"justify":"start","padding":"30px"},"fields":{},"placeholders":{"jssdocs-row":[{"uid":"{F94A78BF-A94F-5553-B046-7355D538AE21}","componentName":"Logo","dataSource":"available-in-connected-mode","params":{"flex":"300px"},"fields":{}},{"uid":"{2512F58E-5DA0-5F64-898B-24F97FD5109B}","componentName":"MainNav","dataSource":"available-in-connected-mode","params":{"flex":"auto"},"fields":{"selectedMenuItem":{"value":"docs"}}}]}}],"jssdocs-main":[{"uid":"{92837B08-3AAE-5A56-8FFE-EB838B478774}","componentName":"ArticleContainer","dataSource":"available-in-connected-mode","params":{},"fields":{},"placeholders":{"jssdocs-jumbo":[{"uid":"{620F3068-918A-576F-AB8E-3E19EE650BE9}","componentName":"FeatureJumboShort","dataSource":"available-in-connected-mode","params":{},"fields":{"image":{"value":{"src":"/assets/img/transparent-1x1.png"}},"imageclass":{"value":"defaultimage"},"csscolorclass":{"value":"default"},"title":{"value":"Documentation"},"text":{"value":"Read and search through all the Sitecore JSS documentation"}}}],"jssdocs-aside":[{"uid":"{D9D9A55C-95C3-532F-9CA2-D3916578BF25}","componentName":"SideNav","dataSource":"available-in-connected-mode","params":{},"fields":{"navType":{"value":"docs"},"useSearch":{"value":"true"}}}],"jssdocs-content":[{"uid":"{0E608A2B-3C2F-5470-9841-0B7EDF83AC15}","componentName":"Article","dataSource":"available-in-connected-mode","params":{},"fields":{"text":{"value":"<h1 id=\"headless-ssr-via-sitecore-jss-proxy\">Headless SSR via <code>sitecore-jss-proxy</code></h1>\n<p>JSS supports headless server-side rendering using any service that supports hosting Node.js applications. In this technique the JSS app receives an incoming HTTP request, which is then rewritten and proxied into a Layout Service request to a Sitecore server. The reply from Layout Service is then provided to the app's SSR infrastructure to render to HTML, the same way that Integrated Mode would work within Sitecore, and then finally the resultant HTML is returned to the client.</p>\n<p>All Sitecore marketing features are supported by this headless mode, including personalization, tracking, multivariate testing, etc.</p>\n<h2 id=\"how-to-use\">How to use</h2>\n<ol>\n<li><p>Clone <a href=\"https://github.com/sitecore/jss\">the JSS samples repository</a> and copy the <code>samples/node-headless-ssr-proxy</code> folder to your disk, for example: <code>c:\\jss-headless</code>.</p>\n<p>This sample app acts as a HTTP proxy to the Sitecore server, proxying incoming requests to Layout Service, and then rendering the resultant JSON to HTML before returning it. The app is heavily commented.</p></li>\n<li><p>Create a production build of your app with <code>jss build</code>. Ensure that the <code>layoutServiceHost</code> in the app's <code>scjssconfig.json</code> is set to the hostname <em>of the <code>node-headless-ssr-proxy</code> proxy</em> (not directly to Sitecore). For local testing, this would default to <code>http://localhost:3000</code>. In production, it would likely be something like <code>https://www.mysite.com</code>. It is also possible to make requests directly to Sitecore, if you do not wish to run everything through the reverse proxy. Proxying the data APIs has the advantage of allowing Sitecore to live behind a firewall.</p></li>\n<li><p>Copy the production build artifacts from your app to the proxy (i.e. <code>/node-headless-ssr-proxy/dist/MyApp</code>). The path copied to should match the relative path that is set in the <code>sitecoreDistPath</code> config in the app's <code>package.json</code> file (<code>/dist/MyApp</code> in the previous example).</p></li>\n<li><p>Open <code>/config.js</code> file and,</p>\n<ul>\n<li>Set <code>bundlePath</code> to the path to your built JSS app's <code>server.bundle.js</code>, i.e. <code>'./dist/myappname/server.bundle'</code></li>\n<li>Set <code>apiHost</code> to your Sitecore instance host and the <code>apiKey</code> to your SSC API Key (see <a href=\"/docs/getting-started/jss-server-install\">server setup</a> if you don't have an API key yet)</li>\n<li>Set <code>apiKey</code> to your Sitecore SSC API key</li>\n<li>Set the dictionary service path in <code>createViewBag()</code> to your app's dictionary service URL. If you are not using dictionaries, you can remove the whole <code>createViewBag()</code> function, which enables dictionary caching.</li></ul>\n<blockquote>\n  <p>NOTE: It is possible to configure these settings using environment variables as well, if that is preferable. This is great for containers and some PaaS hosts.</p>\n</blockquote></li>\n<li><p>Open a command line in your <code>node-headless-ssr-proxy</code> folder, and run <code>npm install</code> then <code>npm start</code>.</p>\n<p>The console should show <code>server listening on port 3000!</code>.<br />\nTo test, browse to <code>http://localhost:3000/</code> and you should see the same app rendering now in the headless configuration.</p></li>\n</ol>\n<h2 id=\"tips--tricks\">Tips &amp; Tricks</h2>\n<h3 id=\"media-urls-in-headless-mode\">Media URLs in headless mode</h3>\n<p>The <a href=\"/docs/fundamentals/services/layout-service\">Layout Service</a> will return URLs to images with the Sitecore server URL included. For example:</p>\n<ul>\n<li>The Sitecore server is <code>http://siteco.re</code></li>\n<li>An image in a media field, or a rich text field, would be returned something like <code>http://sitecor.re/-/media/jss.jpg</code></li>\n<li>In headless mode if the proxy is <code>http://proxy</code>, what we really want is <code>http://proxy/-/media/jss.jpg</code> or even better, <code>/-/media/jss.jpg</code></li>\n</ul>\n<p>In headless mode it is possible to use the headless proxy without exposing the Sitecore server publicly, which makes media URLs that contain the Sitecore server URL problematic. It is easy enough to tell Sitecore to not include the server as part of media requests, however. Place the following contents in a <em>config patch</em> file under <code>App_Config/Include/ADescriptiveName.config</code>:</p>\n<pre><code class=\"xml language-xml\">&lt;configuration xmlns:patch=\"http://www.sitecore.net/xmlconfig/\"&gt;\n  &lt;sitecore&gt;\n    &lt;layoutService&gt;\n      &lt;configurations&gt;\n        &lt;config name=\"jss\"&gt;\n          &lt;rendering&gt;\n            &lt;renderingContentsResolver&gt;\n              &lt;IncludeServerUrlInMediaUrls&gt;false&lt;/IncludeServerUrlInMediaUrls&gt;\n            &lt;/renderingContentsResolver&gt;\n          &lt;/rendering&gt;\n        &lt;/config&gt;\n      &lt;/configurations&gt;\n    &lt;/layoutService&gt;\n  &lt;/sitecore&gt;\n&lt;/configuration&gt;\n</code></pre>\n<blockquote>\n  <p>NOTE: this configuration is appropriate for servers that run <em>headless mode</em> or <em>integrated mode</em> JSS sites - generally Content Delivery servers. Enabling this configuration will cause images to break when JSS sites are run in <em>connected mode</em>, as the images will be served as if local - so do not enable this for servers where development is occurring.</p>\n</blockquote>\n"}}}]}}],"jssdocs-footer":[{"uid":"{39EB4302-504F-5EC8-B9B0-AF7D999CFCE5}","componentName":"Row","dataSource":"available-in-connected-mode","params":{"justify":"center","compactGutter":"24","fullSizeGutter":"32"},"fields":{},"placeholders":{"jssdocs-row":[{"uid":"{D9A1CC31-D3B4-538D-8374-6088BE57C4A2}","componentName":"FooterNav","dataSource":"available-in-connected-mode","params":{},"fields":{}}]}},{"uid":"{34949B21-CE7B-552A-B1EA-7A1FEA57615C}","componentName":"Row","dataSource":"available-in-connected-mode","params":{"justify":"center","margin":"30px"},"fields":{},"placeholders":{"jssdocs-row":[{"uid":"{99FD633E-BD4F-58E9-8C84-C63817EE68F6}","componentName":"Disclaimers","dataSource":"available-in-connected-mode","params":{},"fields":{}}]}}]}}},"viewBag":{}};</script><script src="/assets/js/highlight.pack.js"></script><script src="/dist/vendor-client.bundle.js"></script><script src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script><script src="/dist/client.bundle.js"></script></body></html>