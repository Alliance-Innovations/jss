<!DOCTYPE html>
<html lang="en" data-reactroot=""><head><link rel="stylesheet" href="/dist/server.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css"/><link rel="stylesheet" href="/dist/client.css"/><link rel="icon" type="image/png" href="/assets/img/favicon-32x32.png"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="description" content="Sitecore JavaScript Services Documentation"/><title data-react-helmet="true">Thinking in JSS | Sitecore JSS Documentation</title></head><body><div id="app"><section class="ant-layout" id="app-wrap"><header class="ant-layout-header"><div class="ant-row ant-row-start" style="padding:30px"><a style="flex:300px" href="/"><img src="/assets/img/sitecore-logo.svg" height="53px" alt="Sitecore JSS" class="logo"/></a><ul flex="auto" style="border-bottom:none" class="ant-menu ant-menu-light ant-menu-root ant-menu-horizontal" role="menu"><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem"><a class="nav-link" href="/features">Features</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem"><a class="nav-link" href="/docs">Documentation</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item ant-menu-item-only-child ant-menu-item-selected" role="menuitem"><a class="nav-link" href="/guides">Guides</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem"><a class="nav-link" target="_blank" rel="noopener noreferrer" href="https://www.sitecore.com/getting-started/developer-trial">Trial</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem"><a class="nav-link" href="/community">Community</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item get-started-button ant-menu-item-only-child" role="menuitem"><a class="btn btn-secondary btn-sm float-left text-white" href="/docs/getting-started/quick-start">Get Started</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="visibility:hidden;position:absolute" role="menuitem"><div class="ant-menu-submenu-title" role="button" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li></ul></div></header><div class="main-wrapper"><section class="ant-layout border-bottom"><section class="jumbo-container jumbo-container-short bg-light"><div class="default"><div class="circleContainer"><div class="circleContainer-outer-top"><div class="circleContainer-inner"><div class="circleContainer-inner-primary"><div class="circ circ_right circle-fg-right-lg bg-success" id="defaultimage"><img src="/assets/img/transparent-1x1.png"/></div></div><div class="circleContainer-inner-secondary"><div class="circ circ_right circle-fg-right-lg-sub bg-primary"></div></div></div></div><div class="circleContainer-outer-bottom"><div class="circleContainer-inner"><div class="circleContainer-inner-primary"><div class="circle circle-fg-left-md bg-success"></div></div></div></div></div><div class="shapes-wrapper"><div class="outer-shape container"><div class="inner-shape row"><div class="content-wrapper col-12 col-md-9 min-height"><div class="content-wrapper-inner"><h1 class="title mb-3">Guides, Patterns, &amp; Recommended Practices</h1><p class="copy mb-0 p-0">A collection of learnings and recommendations from our developers and community, based on learnings from real-world projects.</p></div></div></div></div></div></div></section></section><div class="ant-row ant-row-space-between" style="margin-left:-20px;margin-right:-20px;flex-wrap:nowrap;margin:30px"><div style="padding-left:20px;padding-right:20px;flex:0 0 300px" class="ant-col"><aside><div class="side-nav"><ul class="ant-menu ant-menu-light ant-menu-root ant-menu-inline" role="menu"><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" role="button" aria-expanded="true" aria-owns="0$Menu" aria-haspopup="true" title="Thinking in JSS">Thinking in JSS<i class="ant-menu-submenu-arrow"></i></div><ul id="0$Menu" class="ant-menu ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item ant-menu-item-only-child" role="menuitem" style="padding-left:48px"><a href="/guides/thinking-in-jss/js-vs-jss">JS Apps vs JSS Apps</a></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem" style="padding-left:48px"><a href="/guides/thinking-in-jss/terminology">Sitecore Terminology &amp; Concepts</a></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem" style="padding-left:48px"><a href="/guides/thinking-in-jss/project-structure">Project Structure</a></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem" style="padding-left:48px"><a href="/guides/thinking-in-jss/developer-workflows">Developer Workflows</a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" role="button" aria-expanded="true" aria-owns="1$Menu" aria-haspopup="true" title="Code Patterns">Code Patterns<i class="ant-menu-submenu-arrow"></i></div><ul id="1$Menu" class="ant-menu ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item ant-menu-item-only-child" role="menuitem" style="padding-left:48px"><a href="/guides/code-patterns/layout-service">Layout Service Customization</a></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem" style="padding-left:48px"><a href="/guides/code-patterns/media-handling">Media Handling</a></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem" style="padding-left:48px"><a href="/guides/code-patterns/routing">Routing</a></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem" style="padding-left:48px"><a href="/guides/code-patterns/ssr">SSR Recommendations</a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" role="button" aria-expanded="true" aria-owns="2$Menu" aria-haspopup="true" title="Multisite Scenarios">Multisite Scenarios<i class="ant-menu-submenu-arrow"></i></div><ul id="2$Menu" class="ant-menu ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item ant-menu-item-only-child" role="menuitem" style="padding-left:48px"><a href="/guides/multisite/content-patterns">Content Patterns</a></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem" style="padding-left:48px"><a href="/guides/multisite/implementation-patterns">Implementation Patterns</a></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem" style="padding-left:48px"><a href="/guides/multisite/multi-language-support">Multi-Lingual Support</a></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem" style="padding-left:48px"><a href="/guides/multisite/sxa-integration">SXA Integration</a></li></ul></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem" style="padding-left:24px"><a class="active" aria-current="page" href="/guides/performance">Performance</a></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" role="button" aria-expanded="true" aria-owns="4$Menu" aria-haspopup="true" title="Debugging">Debugging<i class="ant-menu-submenu-arrow"></i></div><ul id="4$Menu" class="ant-menu ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item ant-menu-item-only-child" role="menuitem" style="padding-left:48px"><a href="/guides/error-handling-debugging/setup-checklist">Setup Checklist</a></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem" style="padding-left:48px"><a href="/guides/error-handling-debugging/common-pitfalls">Common Pitfalls</a></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem" style="padding-left:48px"><a href="/guides/error-handling-debugging/js-validation">Validation in JS</a></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem" style="padding-left:48px"><a href="/guides/error-handling-debugging/http-status-codes">HTTP Status Codes</a></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem" style="padding-left:48px"><a href="/guides/error-handling-debugging/debugging-help">Debugging Help</a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" role="button" aria-expanded="true" aria-owns="5$Menu" aria-haspopup="true" title="GraphQL">GraphQL<i class="ant-menu-submenu-arrow"></i></div><ul id="5$Menu" class="ant-menu ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item ant-menu-item-only-child" role="menuitem" style="padding-left:48px"><a href="/guides/graphql/extending-graphql">Extending GraphQL</a></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem" style="padding-left:48px"><a href="/guides/graphql/graphql-security">Security</a></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem" style="padding-left:48px"><a href="/guides/graphql/query-recipes">Query Recipes</a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" role="button" aria-expanded="true" aria-owns="6$Menu" aria-haspopup="true" title="🚧 Work in Progress">🚧 Work in Progress<i class="ant-menu-submenu-arrow"></i></div><ul id="6$Menu" class="ant-menu ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item ant-menu-item-only-child" role="menuitem" style="padding-left:48px"><a href="/guides/wip/deployment-topologies">Deployment Topologies</a></li><li class="ant-menu-item ant-menu-item-only-child" role="menuitem" style="padding-left:48px"><a href="/guides/wip/migration-guide">Migration Guide</a></li></ul></li></ul><div class="navbar-nav bd-navbar-nav flex-column"></div></div></aside></div><div style="padding-left:20px;padding-right:20px;flex:auto" class="ant-col"><main><h1>Thinking in JSS</h1><section class="toc-container"><div class="title">In this guide</div><div match="[object Object]" location="[object Object]" history="[object Object]"><div class="toc">
<ul>
<li><a href="#cache-as-much-of-the-things-as-you-can">Cache as much of the things as you can!</a><ul>
<li><a href="#sitecore-cache">Sitecore cache</a></li>
<li><a href="#node-server-cache">Node Server Cache</a></li>
<li><a href="#service-worker-and-http-cache">Service worker and HTTP cache</a></li>
<li><a href="#minimize-requests-to-the-server">Minimize Requests to the Server</a></li>
</ul>
</li>
<li><a href="#infrastructure">Infrastructure</a><ul>
<li><a href="#node-clusters">Node clusters</a></li>
<li><a href="#azure-webapps">Azure WebApps</a></li>
</ul>
</li>
<li><a href="#integrated-mode-in-prod">Integrated Mode in Prod</a></li>
<li><a href="#enable-keep-alive">Enable Keep-alive</a></li>
<li><a href="#reference-framework-specific-guides">Reference Framework-Specific Guides</a></li>
<li><a href="#dont-forget-the-browser-layer">Don't forget the browser layer</a></li>
</ul>
</div>

</div></section><div class="article markdown-section" match="[object Object]" location="[object Object]" history="[object Object]"><p>Performance Optimization is a complex topic because different optimizations can be enacted at each layer of the web stack. It's not a "front-end problem" or "back-end problem" or a "devops problem". Everyone involved in building and deploying the app should analyze their slice of the stack and work together to adhere to a <a href="https://web.dev/performance-budgets-101/">performance budget</a>.</p>
<h2 id="cache-as-much-of-the-things-as-you-can">Cache as much of the things as you can!</h2>
<blockquote>
  <p>⚠️ TODO: The <a href="/docs/techniques/performance/caching">caching page in Docs</a> has addition content and examples on this topic. Need to merge together (probably under guides).</p>
</blockquote>
<h3 id="sitecore-cache">Sitecore cache</h3>
<p>Enable Sitecore HTML cache (aka output cache or component cache) on components or groups of components that get reused often (ex. Header, Footer), and on process-intensive components.</p>
<p>Avoid caching personalized components, unless a custom way to fetch personalized data has been added.</p>
<p>Follow the  <a href="https://doc.sitecore.com/developers/93/platform-administration-and-architecture/en/configure-html-component-cache-values.html">official guidelines for enabling and configuring HTML caching</a> .<br />
&nbsp;</p>
<ul>
<li>Use HTTP cache headers to make browsers cache static assets that don’t change often<br />
Reference:  <a href="https://devcenter.heroku.com/articles/increasing-application-performance-with-http-cache-headers">“Increasing Application Performance with HTTP Cache Headers” by Heroku</a> <br />
&nbsp;</li>
<li>Avoid using JavaScript Renderings unless there’s absolutely no other way. This type of rendering initializes a new Node instances for each rendering, for even having more than 2-3 on a page can noticeably influence load times.</li>
</ul>
<h3 id="node-server-cache">Node Server Cache</h3>
<blockquote>
  <p>Warning: Node is a 3rd party software, so using Node caching modules is not something supported by Sitecore. Since the output from Node is the HTML for the entire page, Node caching is all-or-nothing. In other words, if you are using personalization on parts of the page, there is no way to tell Node to exclude parts of the page from the cache.</p>
</blockquote>
<p>Node caching modules:</p>
<ul>
<li><a href="https://www.npmjs.com/package/node-cache">Node Cache</a></li>
<li><a href="https://www.npmjs.com/package/node-cache-redis">Node Redis Cache</a></li>
</ul>
<p>Considerations: implement a cache-invalidation strategy</p>
<h3 id="service-worker-and-http-cache">Service worker and HTTP cache</h3>
<p>Refer to <a href="https://web.dev/service-worker-caching-and-http-caching/">this guide</a> from Google Developers</p>
<hr />
<h3 id="minimize-requests-to-the-server">Minimize Requests to the Server</h3>
<p>A common pitfall we've noticed teams stumble on is setting up routing in such a way that every route-change by the end-user loads an SSR-ed page. This makes node a bottle-neck for your app, and wastes all those great built-in optimizations that front-end frameworks contain for working with the DOM in a browser. The expected behavior for a SPA is that, only the first page that the end-user loads is SSR-ed. Afterwards, client-side rendering should take over, and as the end-user navigates through the site, routes load via CSR.</p>
<blockquote>
  <p>If you're not sure whether your app is set up correctly, inspect the Network tab as you change routes. If the response from the server is Layout Service JSON only, then all is good. But if you're getting back a full HTML page each time, then you are experiencing the above issue. For instructions on how to resolve this, see the <a href="/guides/code-patterns-routing">routing guide</a>.</p>
</blockquote>
<hr />
<h2 id="infrastructure">Infrastructure</h2>
<h3 id="node-clusters">Node clusters</h3>
<p>By default, Node executes code on a <strong>single thread</strong> (for memory efficiency). The <code>Cluster</code> module allows you to handle a greater processing load by taking advantage of multi-core systems and create child processes that each run on their own single thread.</p>
<p>Generally speaking, it's a good idea to have at least as many node processes as physical/virtual/hyper-threaded cores. Performance testing will give the best guidance for fine-tuning this in a specific codebase/environment.</p>
<p><a href="https://nodejs.org/api/cluster.html">Node docs: how to run a cluster</a></p>
<h3 id="azure-webapps">Azure WebApps</h3>
<p>It's technically possible to have the CD server and Node.js running on a single WebApp, but this is not recommended. Sharing the service plan means sharing the Azure CPU resources between Node and CD, which can have unpredictable results for scalability. The best solution for scaling is to have dedicated app service plans for the headless Node rendering farm and the CDs.</p>
<hr />
<h2 id="integrated-mode-in-prod">Integrated Mode in Prod</h2>
<p>To clarify some confusion about <a href="https://jss.sitecore.com/docs/fundamentals/application-modes">application modes</a>, we want to reiterate that in Production,</p>
<ul>
<li>Content Management servers must use Integrated mode (this is required to support Experience Editor)</li>
<li>Content Delivery servers are recommended to avoid using Integrated Mode because it does not scale well and cannot support high traffic.</li>
</ul>
<hr />
<h2 id="enable-keep-alive">Enable Keep-alive</h2>
<p><code>keep-alive</code> is an HTTP mechanism that allows the same TCP connection to be kept open and reused across many HTTP requests. It reduces the amount of hand-shaking, and thus latency, for every request that’s kept alive by reusing one TCP connection.</p>
<ul>
<li><strong>For responses handled by Node</strong>: <code>keep-alive</code> is not enabled by default in Node servers, unless the <a href="https://www.npmjs.com/package/agentkeepalive">agentkeepalive package</a> is installed.</li>
<li><strong>For all other responses</strong> (for example, API calls that bypass the Node proxy): add <code>Connection: keep-alive</code> to the response headers.</li>
</ul>
<p>Reference and additional information: <a href="https://docs.microsoft.com/en-us/azure/app-service/troubleshoot-intermittent-outbound-connection-errors#node">Microsoft Docs - Troubleshooting intermittent outbound connection errors in Azure App Service</a></p>
<p>Note: <code>keep alive</code> will be included in future versions of the <code>node-proxy</code> sample. <a href="https://github.com/Sitecore/jss/blob/keep-alive-feature/samples/node-headless-ssr-proxy/config.js#L31">Git reference</a>.</p>
<blockquote>
  <p>Special thank you to <a href="https://twitter.com/unaverhoeven">Una Verhoeven</a> for insights on this topic.</p>
</blockquote>
<hr />
<h2 id="reference-framework-specific-guides">Reference Framework-Specific Guides</h2>
<p>Every framework provides guidance on configuration changes that should be turned on in production that enable additional optimizations.</p>
<ul>
<li><a href="https://reactjs.org/docs/optimizing-performance.html">React's 'Optimizing Performance' Guide</a></li>
<li><a href="https://vuejs.org/v2/guide/deployment.html">Vue's 'Production Deployment' Guide</a></li>
<li><a href="https://angular.io/guide/deployment#production-optimizations">Angular's 'Production optiimizations' Guide</a></li>
</ul>
<hr />
<h2 id="dont-forget-the-browser-layer">Don't forget the browser layer</h2>
<p>All the little rules we've heard over the years - avoid JS bloat, avoid render-blocking scripts above the fold, defer image loading, etc - individually, they may seem insignificant compared to the huge boosts seen by something like enabling <code>keep-alive</code>, - but together they do add up and they do impact your front-end load speeds. Modern browsers come with amazing developer tools that not only identify these issues, but tell us how to fix them.</p>
<p>Reference <a href="https://web.dev/fast/">Google Developers' guide "Fast load times"</a> for a large collection of guides on this topic.</p>
</div><hr/><div>Found a problem? Have something to add? <a href="https://github.com/Sitecore/jss/edit/guides/docs/data/routes/guides/thinking-in-jss/en.md">Edit this on GitHub</a></div></main></div></div></div><footer class="ant-layout-footer"><div class="ant-row ant-row-center" style="margin-left:-16px;margin-right:-16px"><div style="padding-left:16px;padding-right:16px" class="ant-col ant-col-xs-24 ant-col-md-5"><a class="nav-link text-uppercase small text-white font-weight-bold" href="/features">Features</a><nav class="nav flex-column"><a class="nav-link small text-white" href="/features/why-jss">Why JSS?</a><a class="nav-link small text-white" href="/features/why-sitecore">Why Sitecore?</a></nav></div><div style="padding-left:16px;padding-right:16px" class="ant-col ant-col-xs-24 ant-col-md-5"><a class="nav-link text-uppercase small text-white font-weight-bold" href="/docs">Documentation</a><nav class="nav flex-column"><a class="nav-link small text-white" href="/docs/getting-started/quick-start">Getting Started</a><a class="nav-link small text-white" href="/docs/fundamentals/architecture">Fundamentals</a><a class="nav-link small text-white" href="/docs/client-frameworks/react/react-overview">Client Frameworks</a><a class="nav-link small text-white" href="/docs/techniques/mvc-integration/javascript-rendering">Techniques</a><a class="nav-link small text-white" href="/release-notes">Release Notes</a><a class="nav-link small text-white" href="/help">FAQs</a></nav></div><div style="padding-left:16px;padding-right:16px" class="ant-col ant-col-xs-24 ant-col-md-5"><a href="https://www.sitecore.com/getting-started/developer-trial" target="_blank" rel="noopener noreferrer" class="nav-link text-uppercase small text-white font-weight-bold">Start Trial</a></div><div style="padding-left:16px;padding-right:16px" class="ant-col ant-col-xs-24 ant-col-md-5"><a class="nav-link text-uppercase small text-white font-weight-bold" href="/community">Community</a><nav class="nav flex-column"><a href="#" class="nav-link small text-white">Sitecore Community</a><a href="slack://channel?team=T09SHRBNU&amp;id=C7JT0NRQW" class="nav-link small text-white"><svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" focusable="false"><title>Slack</title><path fill="currentColor" d="M210.787 234.832l68.31-22.883 22.1 65.977-68.309 22.882z"></path><path d="M490.54 185.6C437.7 9.59 361.6-31.34 185.6 21.46S-31.3 150.4 21.46 326.4 150.4 543.3 326.4 490.54 543.34 361.6 490.54 185.6zM401.7 299.8l-33.15 11.05 11.46 34.38c4.5 13.92-2.87 29.06-16.78 33.56-2.87.82-6.14 1.64-9 1.23a27.32 27.32 0 0 1-24.56-18l-11.46-34.38-68.36 22.92 11.46 34.38c4.5 13.92-2.87 29.06-16.78 33.56-2.87.82-6.14 1.64-9 1.23a27.32 27.32 0 0 1-24.56-18l-11.46-34.43-33.15 11.05c-2.87.82-6.14 1.64-9 1.23a27.32 27.32 0 0 1-24.56-18c-4.5-13.92 2.87-29.06 16.78-33.56l33.12-11.03-22.1-65.9-33.15 11.05c-2.87.82-6.14 1.64-9 1.23a27.32 27.32 0 0 1-24.56-18c-4.48-13.93 2.89-29.07 16.81-33.58l33.15-11.05-11.46-34.38c-4.5-13.92 2.87-29.06 16.78-33.56s29.06 2.87 33.56 16.78l11.46 34.38 68.36-22.92-11.46-34.38c-4.5-13.92 2.87-29.06 16.78-33.56s29.06 2.87 33.56 16.78l11.47 34.42 33.15-11.05c13.92-4.5 29.06 2.87 33.56 16.78s-2.87 29.06-16.78 33.56L329.7 194.6l22.1 65.9 33.15-11.05c13.92-4.5 29.06 2.87 33.56 16.78s-2.88 29.07-16.81 33.57z" fill="currentColor"></path></svg>JSS Slack</a><a href="https://sitecore.stackexchange.com/tags/jss" class="nav-link small text-white"><svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 120 120"><title>Sitecore StackExchange</title><path fill="currentColor" d="M22.4 57.5h74.8v15.4H22.4z"></path><path fill="currentColor" d="M22.4 37.6h74.8V53H22.4z"></path><path fill="currentColor" d="M85.5 17H34.4c-6.6 0-12 5.5-12 12.3v4h74.8v-4C97.2 22.5 92 17 85.5 17z"></path><path fill="currentColor" d="M22.4 77.3v4c0 6.8 5.4 12.3 12 12.3h32v16.3l15.8-16.3h3.5c6.6 0 12-5.5 12-12.3v-4H22.4z"></path></svg>Stack Exchange</a><a href="https://github.com/sitecore/jss" class="nav-link small text-white"><svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 499.36" focusable="false"><title>GitHub</title><path d="M256 0C114.64 0 0 114.61 0 256c0 113.09 73.34 209 175.08 242.9 12.8 2.35 17.47-5.56 17.47-12.34 0-6.08-.22-22.18-.35-43.54-71.2 15.49-86.2-34.34-86.2-34.34-11.64-29.57-28.42-37.45-28.42-37.45-23.27-15.84 1.73-15.55 1.73-15.55 25.69 1.81 39.21 26.38 39.21 26.38 22.84 39.12 59.92 27.82 74.5 21.27 2.33-16.54 8.94-27.82 16.25-34.22-56.84-6.43-116.6-28.43-116.6-126.49 0-27.95 10-50.8 26.35-68.69-2.63-6.48-11.42-32.5 2.51-67.75 0 0 21.49-6.88 70.4 26.24a242.65 242.65 0 0 1 128.18 0c48.87-33.13 70.33-26.24 70.33-26.24 14 35.25 5.18 61.27 2.55 67.75 16.41 17.9 26.31 40.75 26.31 68.69 0 98.35-59.85 120-116.88 126.32 9.19 7.9 17.38 23.53 17.38 47.41 0 34.22-.31 61.83-.31 70.23 0 6.85 4.61 14.81 17.6 12.31C438.72 464.97 512 369.08 512 256.02 512 114.62 397.37 0 256 0z" fill="currentColor" fill-rule="evenodd"></path></svg>Github</a></nav></div></div><div class="ant-row ant-row-center" style="margin:30px"><div class="ant-col footer-copyright small">© Copyright <!-- -->2020<!-- -->, Sitecore. All Rights Reserved.</div><div class="ant-col footer-copyright small"><a href="https://www.sitecore.com/trust" class="pl-2 pr-2" target="_blank" rel="noopener noreferrer">Legal</a><a href="https://www.sitecore.com/trust/privacy-policy" class="pl-2" target="_blank" rel="noopener noreferrer">Privacy</a></div></div></footer></section></div><script>window.__data={"sitecore":{"context":{"pageEditing":false,"site":{"name":"JssDisconnectedLayoutService"},"pageState":"normal","language":"en"},"route":{"databaseName":"available-in-connected-mode","deviceId":"available-in-connected-mode","itemId":"available-in-connected-mode","itemLanguage":"en","itemVersion":1,"layoutId":"available-in-connected-mode","templateId":"available-in-connected-mode","templateName":"Docs Route","name":"performance","fields":{"title":{"value":"Performance Guide"},"editLink":{"value":{"text":"Edit this on GitHub","href":"https://github.com/Sitecore/jss/edit/guides/docs/data/routes/guides/performance/en.md"}}},"placeholders":{"jssdocs-header":[{"uid":"{21825DB8-7ED4-574C-AB43-F8EAEB0B6F56}","componentName":"Row","dataSource":"available-in-connected-mode","params":{"justify":"start","padding":"30px"},"fields":{},"placeholders":{"jssdocs-row":[{"uid":"{3B24BC2D-A78C-53F1-9A94-B0E2F91D4026}","componentName":"Logo","dataSource":"available-in-connected-mode","params":{"flex":"300px"},"fields":{}},{"uid":"{3D92E7E7-D774-5FA7-90EF-F42C9EB670C6}","componentName":"MainNav","dataSource":"available-in-connected-mode","params":{"flex":"auto"},"fields":{"selectedMenuItem":{"value":"guides"}}}]}}],"jssdocs-main":[{"uid":"{DEF63664-2760-5F91-91A0-156E97E9D616}","componentName":"ArticleContainer","dataSource":"available-in-connected-mode","params":{},"fields":{},"placeholders":{"jssdocs-jumbo":[{"uid":"{1CC683D1-3F52-5803-9490-36DEDF929956}","componentName":"FeatureJumboShort","dataSource":"available-in-connected-mode","params":{},"fields":{"image":{"value":{"src":"/assets/img/transparent-1x1.png"}},"imageclass":{"value":"defaultimage"},"csscolorclass":{"value":"default"},"title":{"value":"Guides, Patterns, & Recommended Practices"},"text":{"value":"A collection of learnings and recommendations from our developers and community, based on learnings from real-world projects."}}}],"jssdocs-aside":[{"uid":"{EB1DF0EE-DC3F-5C78-9C25-6AA7C743C01E}","componentName":"SideNav","dataSource":"available-in-connected-mode","params":{},"fields":{"navType":{"value":"guides"},"useSearch":{"value":"false"}}}],"jssdocs-content":[{"uid":"{45C81018-0E74-5F86-A323-E2C08AB3CD44}","componentName":"Guide","dataSource":"available-in-connected-mode","params":{},"fields":{"text":{"value":"<p>Performance Optimization is a complex topic because different optimizations can be enacted at each layer of the web stack. It's not a \"front-end problem\" or \"back-end problem\" or a \"devops problem\". Everyone involved in building and deploying the app should analyze their slice of the stack and work together to adhere to a <a href=\"https://web.dev/performance-budgets-101/\">performance budget</a>.</p>\n<h2 id=\"cache-as-much-of-the-things-as-you-can\">Cache as much of the things as you can!</h2>\n<blockquote>\n  <p>⚠️ TODO: The <a href=\"/docs/techniques/performance/caching\">caching page in Docs</a> has addition content and examples on this topic. Need to merge together (probably under guides).</p>\n</blockquote>\n<h3 id=\"sitecore-cache\">Sitecore cache</h3>\n<p>Enable Sitecore HTML cache (aka output cache or component cache) on components or groups of components that get reused often (ex. Header, Footer), and on process-intensive components.</p>\n<p>Avoid caching personalized components, unless a custom way to fetch personalized data has been added.</p>\n<p>Follow the  <a href=\"https://doc.sitecore.com/developers/93/platform-administration-and-architecture/en/configure-html-component-cache-values.html\">official guidelines for enabling and configuring HTML caching</a> .<br />\n&nbsp;</p>\n<ul>\n<li>Use HTTP cache headers to make browsers cache static assets that don’t change often<br />\nReference:  <a href=\"https://devcenter.heroku.com/articles/increasing-application-performance-with-http-cache-headers\">“Increasing Application Performance with HTTP Cache Headers” by Heroku</a> <br />\n&nbsp;</li>\n<li>Avoid using JavaScript Renderings unless there’s absolutely no other way. This type of rendering initializes a new Node instances for each rendering, for even having more than 2-3 on a page can noticeably influence load times.</li>\n</ul>\n<h3 id=\"node-server-cache\">Node Server Cache</h3>\n<blockquote>\n  <p>Warning: Node is a 3rd party software, so using Node caching modules is not something supported by Sitecore. Since the output from Node is the HTML for the entire page, Node caching is all-or-nothing. In other words, if you are using personalization on parts of the page, there is no way to tell Node to exclude parts of the page from the cache.</p>\n</blockquote>\n<p>Node caching modules:</p>\n<ul>\n<li><a href=\"https://www.npmjs.com/package/node-cache\">Node Cache</a></li>\n<li><a href=\"https://www.npmjs.com/package/node-cache-redis\">Node Redis Cache</a></li>\n</ul>\n<p>Considerations: implement a cache-invalidation strategy</p>\n<h3 id=\"service-worker-and-http-cache\">Service worker and HTTP cache</h3>\n<p>Refer to <a href=\"https://web.dev/service-worker-caching-and-http-caching/\">this guide</a> from Google Developers</p>\n<hr />\n<h3 id=\"minimize-requests-to-the-server\">Minimize Requests to the Server</h3>\n<p>A common pitfall we've noticed teams stumble on is setting up routing in such a way that every route-change by the end-user loads an SSR-ed page. This makes node a bottle-neck for your app, and wastes all those great built-in optimizations that front-end frameworks contain for working with the DOM in a browser. The expected behavior for a SPA is that, only the first page that the end-user loads is SSR-ed. Afterwards, client-side rendering should take over, and as the end-user navigates through the site, routes load via CSR.</p>\n<blockquote>\n  <p>If you're not sure whether your app is set up correctly, inspect the Network tab as you change routes. If the response from the server is Layout Service JSON only, then all is good. But if you're getting back a full HTML page each time, then you are experiencing the above issue. For instructions on how to resolve this, see the <a href=\"/guides/code-patterns-routing\">routing guide</a>.</p>\n</blockquote>\n<hr />\n<h2 id=\"infrastructure\">Infrastructure</h2>\n<h3 id=\"node-clusters\">Node clusters</h3>\n<p>By default, Node executes code on a <strong>single thread</strong> (for memory efficiency). The <code>Cluster</code> module allows you to handle a greater processing load by taking advantage of multi-core systems and create child processes that each run on their own single thread.</p>\n<p>Generally speaking, it's a good idea to have at least as many node processes as physical/virtual/hyper-threaded cores. Performance testing will give the best guidance for fine-tuning this in a specific codebase/environment.</p>\n<p><a href=\"https://nodejs.org/api/cluster.html\">Node docs: how to run a cluster</a></p>\n<h3 id=\"azure-webapps\">Azure WebApps</h3>\n<p>It's technically possible to have the CD server and Node.js running on a single WebApp, but this is not recommended. Sharing the service plan means sharing the Azure CPU resources between Node and CD, which can have unpredictable results for scalability. The best solution for scaling is to have dedicated app service plans for the headless Node rendering farm and the CDs.</p>\n<hr />\n<h2 id=\"integrated-mode-in-prod\">Integrated Mode in Prod</h2>\n<p>To clarify some confusion about <a href=\"https://jss.sitecore.com/docs/fundamentals/application-modes\">application modes</a>, we want to reiterate that in Production,</p>\n<ul>\n<li>Content Management servers must use Integrated mode (this is required to support Experience Editor)</li>\n<li>Content Delivery servers are recommended to avoid using Integrated Mode because it does not scale well and cannot support high traffic.</li>\n</ul>\n<hr />\n<h2 id=\"enable-keep-alive\">Enable Keep-alive</h2>\n<p><code>keep-alive</code> is an HTTP mechanism that allows the same TCP connection to be kept open and reused across many HTTP requests. It reduces the amount of hand-shaking, and thus latency, for every request that’s kept alive by reusing one TCP connection.</p>\n<ul>\n<li><strong>For responses handled by Node</strong>: <code>keep-alive</code> is not enabled by default in Node servers, unless the <a href=\"https://www.npmjs.com/package/agentkeepalive\">agentkeepalive package</a> is installed.</li>\n<li><strong>For all other responses</strong> (for example, API calls that bypass the Node proxy): add <code>Connection: keep-alive</code> to the response headers.</li>\n</ul>\n<p>Reference and additional information: <a href=\"https://docs.microsoft.com/en-us/azure/app-service/troubleshoot-intermittent-outbound-connection-errors#node\">Microsoft Docs - Troubleshooting intermittent outbound connection errors in Azure App Service</a></p>\n<p>Note: <code>keep alive</code> will be included in future versions of the <code>node-proxy</code> sample. <a href=\"https://github.com/Sitecore/jss/blob/keep-alive-feature/samples/node-headless-ssr-proxy/config.js#L31\">Git reference</a>.</p>\n<blockquote>\n  <p>Special thank you to <a href=\"https://twitter.com/unaverhoeven\">Una Verhoeven</a> for insights on this topic.</p>\n</blockquote>\n<hr />\n<h2 id=\"reference-framework-specific-guides\">Reference Framework-Specific Guides</h2>\n<p>Every framework provides guidance on configuration changes that should be turned on in production that enable additional optimizations.</p>\n<ul>\n<li><a href=\"https://reactjs.org/docs/optimizing-performance.html\">React's 'Optimizing Performance' Guide</a></li>\n<li><a href=\"https://vuejs.org/v2/guide/deployment.html\">Vue's 'Production Deployment' Guide</a></li>\n<li><a href=\"https://angular.io/guide/deployment#production-optimizations\">Angular's 'Production optiimizations' Guide</a></li>\n</ul>\n<hr />\n<h2 id=\"dont-forget-the-browser-layer\">Don't forget the browser layer</h2>\n<p>All the little rules we've heard over the years - avoid JS bloat, avoid render-blocking scripts above the fold, defer image loading, etc - individually, they may seem insignificant compared to the huge boosts seen by something like enabling <code>keep-alive</code>, - but together they do add up and they do impact your front-end load speeds. Modern browsers come with amazing developer tools that not only identify these issues, but tell us how to fix them.</p>\n<p>Reference <a href=\"https://web.dev/fast/\">Google Developers' guide \"Fast load times\"</a> for a large collection of guides on this topic.</p>\n"},"toc":{"value":"<div class=\"toc\">\n<ul>\n<li><a href=\"#cache-as-much-of-the-things-as-you-can\">Cache as much of the things as you can!</a><ul>\n<li><a href=\"#sitecore-cache\">Sitecore cache</a></li>\n<li><a href=\"#node-server-cache\">Node Server Cache</a></li>\n<li><a href=\"#service-worker-and-http-cache\">Service worker and HTTP cache</a></li>\n<li><a href=\"#minimize-requests-to-the-server\">Minimize Requests to the Server</a></li>\n</ul>\n</li>\n<li><a href=\"#infrastructure\">Infrastructure</a><ul>\n<li><a href=\"#node-clusters\">Node clusters</a></li>\n<li><a href=\"#azure-webapps\">Azure WebApps</a></li>\n</ul>\n</li>\n<li><a href=\"#integrated-mode-in-prod\">Integrated Mode in Prod</a></li>\n<li><a href=\"#enable-keep-alive\">Enable Keep-alive</a></li>\n<li><a href=\"#reference-framework-specific-guides\">Reference Framework-Specific Guides</a></li>\n<li><a href=\"#dont-forget-the-browser-layer\">Don't forget the browser layer</a></li>\n</ul>\n</div>\n\n"}}}]}}],"jssdocs-footer":[{"uid":"{BA446AF1-2ACA-5522-B0F9-91D7A7DE14A8}","componentName":"Row","dataSource":"available-in-connected-mode","params":{"justify":"center","compactGutter":"24","fullSizeGutter":"32"},"fields":{},"placeholders":{"jssdocs-row":[{"uid":"{670AEA4C-2C33-5704-A3CB-E265EC342537}","componentName":"FooterNav","dataSource":"available-in-connected-mode","params":{},"fields":{}}]}},{"uid":"{6E0E4B37-05AB-5EF2-A083-69638DA1D1EE}","componentName":"Row","dataSource":"available-in-connected-mode","params":{"justify":"center","margin":"30px"},"fields":{},"placeholders":{"jssdocs-row":[{"uid":"{7B86B692-DC79-5FA6-BB23-9E605F2A0A1E}","componentName":"Disclaimers","dataSource":"available-in-connected-mode","params":{},"fields":{}}]}}]}}},"viewBag":{}};</script><script src="/assets/js/highlight.pack.js"></script><script src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script><script src="/dist/client.bundle.js"></script></body></html>